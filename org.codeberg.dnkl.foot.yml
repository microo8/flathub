app-id: org.codeberg.dnkl.foot
runtime: org.freedesktop.Platform
runtime-version: "22.08"
sdk: org.freedesktop.Sdk
sdk-extensions:
  - org.freedesktop.Sdk.Extension.golang
command: foot.sh
rename-desktop-file: foot.desktop
rename-icon: foot

finish-args:
  - --socket=wayland
  - --talk-name=org.freedesktop.Flatpak
  - --env=TERM=xterm-256color

modules:
  - name: libutf8proc
    buildsystem: cmake-ninja
    builddir: true
    sources:
      - type: archive
        url: https://github.com/JuliaStrings/utf8proc/archive/refs/tags/v2.7.0.zip
        sha256: 03f6a8e5d22c05d719d44d4fa5692bd8b53624da77905462e3405ada19fa5719
  - name: tllist
    buildsystem: meson
    sources:
      - type: git
        url: https://codeberg.org/dnkl/tllist.git
        tag: 1.1.0
  - name: fcft
    buildsystem: meson
    sources:
      - type: git
        url: https://codeberg.org/dnkl/fcft.git
        tag: 3.1.5
  - name: foot
    buildsystem: meson
    config-opts:
      - -Dterminfo=disabled
    sources:
      - type: git
        url: https://codeberg.org/dnkl/foot.git
        tag: 1.13.1
  - name: foot.sh
    buildsystem: simple
    sources:
      - type: file
        path: ./foot.sh
    build-commands:
      - install -Dm755 ./foot.sh -t /app/bin/
  - name: host-spawn
    buildsystem: simple
    sources:
      - type: archive
        url: https://github.com/1player/host-spawn/archive/refs/tags/1.2.1.zip
        sha256: 6a255bee35f4804d09ff85521632385273bf95a29d1f79e7dadcae6fd02b4d06
        dest: host-spawn
      - type: git
        url: https://github.com/godbus/dbus
        commit: e523abc905595cf17fb0001a7d77eaaddfaa216d
        dest: src/github.com/godbus/dbus/v5
      - type: git
        url: https://github.com/pkg/term
        commit: d02e49dd31404f3c3cf4b5469b28942194e0ca23
        dest: src/github.com/pkg/term
      - type: git
        url: https://go.googlesource.com/sys
        dest: src/golang.org/x/sys
    build-commands:
      - . /usr/lib/sdk/golang/enable.sh; export GOPATH=$PWD; export GO111MODULE=off; cd host-spawn; go build -v
      - install -Dm755 host-spawn/host-spawn -t /app/bin
